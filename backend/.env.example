# =====================================================
# FLOODINGNAQUE BACKEND - ENVIRONMENT CONFIGURATION TEMPLATE
# =====================================================
# 
# USAGE:
#   1. Copy this file to .env.development, .env.staging, or .env.production
#   2. Set APP_ENV to select which file to load:
#      - APP_ENV=development -> loads .env.development
#      - APP_ENV=staging     -> loads .env.staging
#      - APP_ENV=production  -> loads .env.production
#   3. Fill in your environment-specific values
#
# SECURITY:
#   - NEVER commit real API keys or secrets to git
#   - Use separate keys for each environment
#   - Rotate keys immediately if exposed
#

# ====================
# API Keys (REQUIRED)
# ====================
# Get your free API key from: https://openweathermap.org/api
OWM_API_KEY=your_openweathermap_api_key_here
OWM_UNITS=metric
OWM_LANG=en

# Get your free API key from: https://weatherstack.com/
WEATHERSTACK_API_KEY=your_weatherstack_api_key_here

# Note: Meteostat is a Python library and does not require an API key
# It provides historical weather data from public weather stations

# Internal API auth token for microservices 
INTERNAL_API_TOKEN=your_internal_api_token_here

# ====================
# APP Environment
# ====================
APP_ENV=production
ENABLE_HTTPS=True

# ====================
# Database Configuration
# ====================
# SQLite (default for development)
# Format: sqlite:///path/to/file.db
# DATABASE_URL=sqlite:///data/floodingnaque.db

# PostgreSQL (recommended for production)
# DATABASE_URL=postgresql://username:password@localhost:5432/floodingnaque

# Supabase PostgreSQL (RECOMMENDED - cloud hosted)
# Get your connection string from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/database
SUPABASE_URL=https://your-project-ref.supabase.co
SUPABASE_KEY=your_supabase_anon_key_here
SUPABASE_SECRET_KEY=your_supabase_service_role_key_here
# Connection string format: postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres
DATABASE_URL=postgresql://postgres:your_password@db.your-project-ref.supabase.co:5432/postgres

# MySQL (alternative)
# DATABASE_URL=mysql+pymysql://username:password@localhost:3306/floodingnaque

# ====================
# Server Configuration
# ====================
PORT=5000
HOST=0.0.0.0
FLASK_DEBUG=False
# FLASK_ENV is deprecated in Flask 2.3+ - use FLASK_DEBUG instead

# ====================
# Security Settings
# ====================
SECRET_KEY=change_this_to_a_random_secret_key_in_production
JWT_SECRET_KEY=change_this_to_another_random_secret_key

# API Key Authentication
# Comma-separated list of valid API keys for protecting sensitive endpoints
# Generate secure keys using: python -c "import secrets; print(secrets.token_urlsafe(32))"
VALID_API_KEYS=your_api_key_1,your_api_key_2

# Enable auth bypass in development (NEVER in production!)
AUTH_BYPASS_ENABLED=False

# Request Size Limits (in MB)
MAX_CONTENT_LENGTH_MB=1

# Model Integrity and Security
VERIFY_MODEL_INTEGRITY=True
REQUIRE_MODEL_SIGNATURE=False
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
MODEL_SIGNING_KEY=

# ====================
# Alert System 
# ====================
# SMS Gateway Configuration
# Supported providers: semaphore (Philippines), twilio (International)
SMS_ENABLED=False
SMS_SANDBOX_MODE=True
SMS_PROVIDER=semaphore

# Semaphore SMS (Philippines - Affordable) - https://semaphore.co/
SEMAPHORE_API_KEY=
SEMAPHORE_SENDER_NAME=FloodAlert

# Twilio SMS (International) - https://twilio.com/
TWILIO_ACCOUNT_SID=
TWILIO_AUTH_TOKEN=
TWILIO_FROM_NUMBER=

# Email Configuration (SMTP)
EMAIL_ENABLED=False
EMAIL_SANDBOX_MODE=True
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=
SMTP_USE_TLS=True

# ====================
# Logging Configuration
# ====================
LOG_LEVEL=INFO
LOG_FILE=logs/floodingnaque.log
LOG_FORMAT=json
LOG_MAX_SIZE_MB=10
LOG_BACKUP_COUNT=5
LOG_COMPRESS=True

# ====================
# Rate Limiting
# ====================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_WINDOW_SECONDS=3600
# Use redis:// for production (recommended), memory:// for development
RATE_LIMIT_STORAGE_URL=memory://
# Example Redis: redis://localhost:6379/0

# ====================
# Parañaque City Default Coordinates
# ====================
DEFAULT_LATITUDE=14.4793
DEFAULT_LONGITUDE=121.0198
DEFAULT_LOCATION=Parañaque City

# ====================
# Model Configuration
# ====================
MODEL_DIR=models
MODEL_NAME=flood_rf_model
MODEL_VERSION=1.0
MODEL_RETRAIN_CRON=0 0 * * *
AUTO_RETRAIN=False
RETRAIN_INTERVAL_DAYS=30

# ====================
# Data Retention
# ====================
WEATHER_DATA_RETENTION_DAYS=365
PREDICTION_DATA_RETENTION_DAYS=180
ALERT_HISTORY_RETENTION_DAYS=90

# ====================
# Performance & Database Pool
# ====================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=3600
DB_POOL_TIMEOUT=30

# Redis Caching (optional but recommended for production)
# Format: redis://[[username]:[password]]@localhost:6379/0
REDIS_URL=

# Simple cache settings (when Redis not available)
CACHE_ENABLED=False
CACHE_TYPE=simple
CACHE_DEFAULT_TIMEOUT=300

# ====================
# CORS Configuration
# ====================
CORS_ORIGINS=https://floodingnaque.vercel.app
CORS_METHODS=GET,POST,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization

# ====================
# Scheduler Configuration
# ====================
SCHEDULER_ENABLED=True
SCHEDULER_TIMEZONE=Asia/Manila
DATA_INGEST_INTERVAL_HOURS=1
MODEL_EVALUATION_INTERVAL_DAYS=7
DATABASE_CLEANUP_INTERVAL_DAYS=1

# ====================
# Data Directory Pointers
# ====================
# Avoid hard-coding paths - configure directories here
DATA_DIR=data
LOGS_DIR=logs
UPLOADS_DIR=uploads
TEMP_DIR=temp
BACKUP_DIR=backups

# ====================
# Security Headers
# ====================
# HTTPS/HSTS Settings (enforced by security middleware)
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=True
HSTS_PRELOAD=False

# Cross-Origin Policies (for APIs)
# Note: These are configured but may need implementation in security middleware
# COEP = Cross-Origin-Embedder-Policy
# COOP = Cross-Origin-Opener-Policy  
# CORP = Cross-Origin-Resource-Policy
COEP_POLICY=unsafe-none
COOP_POLICY=same-origin-allow-popups
CORP_POLICY=cross-origin

# Content Security Policy (customize for your frontend)
# Uncomment and customize if you need CSP headers
# CSP_POLICY=default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'

# ====================
# Encryption Settings
# ====================
# Data encryption at rest
ENCRYPTION_ENABLED=True
ENCRYPTION_KEY=generate_a_64_character_hex_key_using_secrets_module
ENCRYPTION_ALGORITHM=AES-256-GCM
# Token encryption
TOKEN_ENCRYPTION_KEY=generate_another_64_character_hex_key_using_secrets_module
TOKEN_EXPIRY_HOURS=24

# ====================
# IP Whitelist (Admin Dashboard)
# ====================
# Comma-separated list of allowed IPs for admin access
IP_WHITELIST_ENABLED=True
ADMIN_ALLOWED_IPS=127.0.0.1,::1
ADMIN_DASHBOARD_ENABLED=True
ADMIN_REQUIRE_2FA=True

# ====================
# Feature Toggles
# ====================
# Enable/disable features without code changes
FEATURE_PREDICTIONS_ENABLED=True
FEATURE_ALERTS_ENABLED=True
FEATURE_HISTORICAL_DATA_ENABLED=True
FEATURE_REAL_TIME_WEATHER_ENABLED=True
FEATURE_MODEL_RETRAINING_ENABLED=False
FEATURE_API_DOCS_ENABLED=True
FEATURE_ADMIN_DASHBOARD_ENABLED=True
FEATURE_EXPORT_DATA_ENABLED=True

# ====================
# Observability & Telemetry
# ====================
# Application Performance Monitoring (APM)
TELEMETRY_ENABLED=True
APM_SERVICE_NAME=floodingnaque-backend
APM_ENVIRONMENT=production

# OpenTelemetry Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_TRACES_ENABLED=False
OTEL_METRICS_ENABLED=False
OTEL_LOGS_ENABLED=False

# Sentry Error Tracking (optional but recommended for production)
# Get your DSN from: https://sentry.io/settings/projects/
# Format: https://<key>@<organization>.ingest.sentry.io/<project-id>
# To set up Sentry, follow these steps:
# 1. Create a Sentry account and project
# 2. Install the Sentry SDK: pip install sentry-sdk
# 3. Configure your DSN and environment below
SENTRY_DSN=
SENTRY_ENVIRONMENT=production
SENTRY_RELEASE=2.0.0

# Performance Monitoring (0.0 to 1.0)
# 0.1 = 10% of transactions are sent to Sentry
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_PROFILES_SAMPLE_RATE=0.1

# Prometheus Metrics
PROMETHEUS_METRICS_ENABLED=True
METRICS_ENABLED=False
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Check Configuration
HEALTH_CHECK_INCLUDE_DETAILS=True
HEALTH_CHECK_DB_TIMEOUT_SECONDS=5

# ====================
# Google Cloud / Earth Engine Configuration
# ====================
# Project ID from Google Cloud Console
GOOGLE_CLOUD_PROJECT=astral-archive-482008-g2

# OAuth 2.0 Client (for user-facing auth)
GOOGLE_OAUTH_CLIENT_ID=your-client-id.apps.googleusercontent.com
GOOGLE_OAUTH_CLIENT_SECRET=your-client-secret

# Service Account (for server-to-server auth - RECOMMENDED)
# Path to the service account JSON key file
GOOGLE_APPLICATION_CREDENTIALS=./floodingnaque-service-account.json

# Service Account Email
GOOGLE_SERVICE_ACCOUNT_EMAIL=floodingnaque@astral-archive-482008-g2.iam.gserviceaccount.com

# Earth Engine Settings
EARTHENGINE_ENABLED=True
EARTHENGINE_PROJECT=astral-archive-482008-g2
EARTHENGINE_CACHE_DIR=data/earthengine_cache

# BigQuery Settings (for historical weather data)
BIGQUERY_ENABLED=True
BIGQUERY_DATASET=weather_data

# Data Sources Toggle
GPM_PRECIPITATION_ENABLED=True
CHIRPS_PRECIPITATION_ENABLED=True
ERA5_REANALYSIS_ENABLED=True

# ====================
# WorldTides API Configuration
# ====================
# Get your API key from: https://www.worldtides.info/settings
# Provides tidal data for coastal flood prediction
WORLDTIDES_API_KEY=82c40b7e-360f-4d66-bf76-84a7e2e40cdd
WORLDTIDES_ENABLED=True
WORLDTIDES_DATUM=MSL
WORLDTIDES_CACHE_TTL_SECONDS=1800
