# =====================================================
# FLOODINGNAQUE BACKEND - ENVIRONMENT CONFIGURATION
# =====================================================
# Copy this file to .env and fill in your actual values
# NEVER commit .env file with real credentials to version control
# =====================================================

# ====================
# API Keys (REQUIRED)
# ====================
# Get your free API key from: https://openweathermap.org/api
OWM_API_KEY=your_openweathermap_api_key_here
OWM_UNITS=metric
OWM_LANG=en

# Get your free API key from: https://weatherstack.com/
WEATHERSTACK_API_KEY=your_weatherstack_api_key_here

# Internal API auth token for microservices 
INTERNAL_API_TOKEN=

# ====================
# APP Environment
# ====================
APP_ENV=development|production
ENABLE_HTTPS=True|False

# ====================
# Database Configuration
# ====================
# SQLite (default for development)
# Format: sqlite:///path/to/file.db
# DATABASE_URL=sqlite:///data/floodingnaque.db

# PostgreSQL (recommended for production)
# DATABASE_URL=postgresql://username:password@localhost:5432/floodingnaque

# Supabase PostgreSQL (RECOMMENDED - cloud hosted)
# Get your connection string from: https://supabase.com/dashboard/project/YOUR_PROJECT/settings/database
SUPABASE_URL=https://your-project.supabase.co
SUPABASE_KEY=your-supabase-anon-key
SUPABASE_SECRET_KEY=your-supabase-secret-key
# Connection string format: postgresql://postgres.[project-ref]:[password]@aws-0-[region].pooler.supabase.com:6543/postgres
DATABASE_URL=postgresql://postgres:your-password@db.your-project.supabase.co:5432/postgres

# MySQL (alternative)
# DATABASE_URL=mysql+pymysql://username:password@localhost:3306/floodingnaque

# ====================
# Server Configuration
# ====================
PORT=5000
HOST=0.0.0.0
FLASK_DEBUG=False
# FLASK_ENV is deprecated in Flask 2.3+ - use FLASK_DEBUG instead
# FLASK_ENV=production

# ====================
# Security Settings
# ====================
# Generate with: python -c "import secrets; print(secrets.token_hex(32))"
SECRET_KEY=change_this_to_a_random_secret_key_in_production
JWT_SECRET_KEY=change_this_to_another_random_secret_key

# API Key Authentication
# Comma-separated list of valid API keys for protected endpoints
VALID_API_KEYS=
# Enable auth bypass in development (NEVER in production!)
AUTH_BYPASS_ENABLED=False

# Request Size Limits
MAX_CONTENT_LENGTH_MB=1

# Model Integrity Verification
VERIFY_MODEL_INTEGRITY=True

# ====================
# Alert System 
# ====================
# SMS Gateway Configuration (e.g., Twilio)
SMS_ENABLED=False
SMS_SANDBOX_MODE=True
SMS_API_KEY=
SMS_API_SECRET=
SMS_FROM_NUMBER=

# Email Configuration (SMTP)
EMAIL_ENABLED=False
EMAIL_SANDBOX_MODE=True
SMTP_HOST=smtp.gmail.com
SMTP_PORT=587
SMTP_USERNAME=
SMTP_PASSWORD=
SMTP_FROM_EMAIL=
SMTP_USE_TLS=True

# ====================
# Logging Configuration
# ====================
LOG_LEVEL=INFO
LOG_FILE=logs/floodingnaque.log
LOG_FORMAT=json
LOG_MAX_SIZE_MB=10
LOG_BACKUP_COUNT=5
LOG_COMPRESS=True

# ====================
# Rate Limiting
# ====================
RATE_LIMIT_ENABLED=True
RATE_LIMIT_DEFAULT=100
RATE_LIMIT_WINDOW_SECONDS=3600
# Use redis:// for production, memory:// for development
RATE_LIMIT_STORAGE_URL=memory://
# Example Redis: redis://localhost:6379/0

# ====================
# Parañaque City Default Coordinates
# ====================
DEFAULT_LATITUDE=14.4793
DEFAULT_LONGITUDE=121.0198
DEFAULT_LOCATION=Parañaque City

# ====================
# Model Configuration
# ====================
MODEL_DIR=models
MODEL_NAME=flood_rf_model
MODEL_VERSION=1.0
MODEL_RETRAIN_CRON=0 0 * * *
AUTO_RETRAIN=False
RETRAIN_INTERVAL_DAYS=30

# ====================
# Data Retention
# ====================
WEATHER_DATA_RETENTION_DAYS=365
PREDICTION_DATA_RETENTION_DAYS=180
ALERT_HISTORY_RETENTION_DAYS=90

# ====================
# Performance
# ====================
DB_POOL_SIZE=20
DB_MAX_OVERFLOW=10
DB_POOL_RECYCLE=3600
CACHE_ENABLED=False
CACHE_TYPE=simple
CACHE_DEFAULT_TIMEOUT=300

# ====================
# CORS Configuration
# ====================
CORS_ORIGINS=https://floodingnaque.vercel.app
CORS_METHODS=GET,POST,OPTIONS
CORS_ALLOW_HEADERS=Content-Type,Authorization

# ====================
# Scheduler Configuration
# ====================
SCHEDULER_ENABLED=True
SCHEDULER_TIMEZONE=Asia/Manila
DATA_INGEST_INTERVAL_HOURS=1
MODEL_EVALUATION_INTERVAL_DAYS=7
DATABASE_CLEANUP_INTERVAL_DAYS=1

# ====================
# Data Directory Pointers
# ====================
# Avoid hard-coding paths - configure directories here
DATA_DIR=data
LOGS_DIR=logs
UPLOADS_DIR=uploads
TEMP_DIR=temp
BACKUP_DIR=backups

# ====================
# Security Headers
# ====================
# HTTPS/HSTS Settings
ENABLE_HTTPS=True
HSTS_MAX_AGE=31536000
HSTS_INCLUDE_SUBDOMAINS=True
HSTS_PRELOAD=False

# Cross-Origin Policies (for APIs)
COEP_POLICY=unsafe-none
COOP_POLICY=same-origin-allow-popups
CORP_POLICY=cross-origin

# Content Security Policy (customize for your frontend)
CSP_POLICY=default-src 'self'; script-src 'self'; style-src 'self' 'unsafe-inline'; img-src 'self' data: https:; font-src 'self'; connect-src 'self'; frame-ancestors 'none'; base-uri 'self'; form-action 'self'

# ====================
# Encryption Settings
# ====================
# Data encryption at rest
ENCRYPTION_ENABLED=False
ENCRYPTION_KEY=change_this_to_a_32_byte_key_in_production
ENCRYPTION_ALGORITHM=AES-256-GCM
# Token encryption
TOKEN_ENCRYPTION_KEY=change_this_to_another_32_byte_key
TOKEN_EXPIRY_HOURS=24

# ====================
# IP Whitelist (Admin Dashboard)
# ====================
# Comma-separated list of allowed IPs for admin access
IP_WHITELIST_ENABLED=False
ADMIN_ALLOWED_IPS=127.0.0.1,::1
ADMIN_DASHBOARD_ENABLED=True
ADMIN_REQUIRE_2FA=False

# ====================
# Feature Toggles
# ====================
# Enable/disable features without code changes
FEATURE_PREDICTIONS_ENABLED=True
FEATURE_ALERTS_ENABLED=True
FEATURE_HISTORICAL_DATA_ENABLED=True
FEATURE_REAL_TIME_WEATHER_ENABLED=True
FEATURE_MODEL_RETRAINING_ENABLED=False
FEATURE_API_DOCS_ENABLED=True
FEATURE_ADMIN_DASHBOARD_ENABLED=True
FEATURE_EXPORT_DATA_ENABLED=True

# ====================
# Observability & Telemetry
# ====================
# Application Performance Monitoring (APM)
TELEMETRY_ENABLED=False
APM_SERVICE_NAME=floodingnaque-backend
APM_ENVIRONMENT=development

# OpenTelemetry Configuration
OTEL_EXPORTER_OTLP_ENDPOINT=http://localhost:4317
OTEL_TRACES_ENABLED=False
OTEL_METRICS_ENABLED=False
OTEL_LOGS_ENABLED=False

# Sentry Error Tracking (optional)
SENTRY_DSN=
SENTRY_TRACES_SAMPLE_RATE=0.1
SENTRY_ENVIRONMENT=development

# Prometheus Metrics
METRICS_ENABLED=False
METRICS_PORT=9090
METRICS_PATH=/metrics

# Health Check Configuration
HEALTH_CHECK_INCLUDE_DETAILS=False
HEALTH_CHECK_DB_TIMEOUT_SECONDS=5
