# ============================================================================
# WEB FRAMEWORK & API
# ============================================================================
Flask==3.0.3
flask-cors==4.0.1
Werkzeug==3.0.4

# Production Servers
gunicorn==22.0.0  # Linux/macOS/Docker
waitress==3.0.0  # Windows alternative

# ============================================================================
# HTTP & EXTERNAL APIs
# ============================================================================
requests==2.32.3
urllib3>=2.0.0,<3.0.0  # Explicit for security

# ============================================================================
# DATA PROCESSING & MACHINE LEARNING
# ============================================================================
# Core scientific stack - PINNED for ML model reproducibility
# CRITICAL: These versions must match training environment to ensure
# saved models load correctly. Changing versions may break model loading.
# See: app/utils/ml_version_check.py for runtime validation
numpy==2.1.3  # Array serialization in saved models
pandas==2.2.3  # DataFrame structure in preprocessing
scikit-learn==1.8.0  # Model pickle format changes between versions
joblib==1.4.2  # Serialization format for .joblib files
scipy==1.14.1  # Used internally by scikit-learn

# ============================================================================
# SCHEDULING & BACKGROUND TASKS
# ============================================================================
APScheduler==3.10.4
celery==5.4.0  # Distributed task queue for background processing

# ============================================================================
# CONFIGURATION & ENVIRONMENT
# ============================================================================
python-dotenv==1.0.1

# ============================================================================
# DATABASE & ORM
# ============================================================================
SQLAlchemy==2.0.35
alembic==1.13.3
pg8000==1.31.2  # Pure Python PostgreSQL driver (Windows/development compatible)
psycopg2-binary==2.9.10  # Faster C-based driver for Linux/Docker production
                          # Both drivers are installed; code auto-selects based on platform

# ============================================================================
# DATA VISUALIZATION
# ============================================================================
matplotlib==3.9.2
seaborn==0.13.2

# ============================================================================
# SECURITY & AUTHENTICATION
# ============================================================================
cryptography==45.0.7,<47  # Latest security patches
itsdangerous==2.2.0
bcrypt==4.3.0
PyJWT==2.9.0  # For JWT token-based authentication

# ============================================================================
# INPUT VALIDATION & SANITIZATION
# ============================================================================
validators==0.34.0
bleach==6.2.0
email-validator==2.2.0  # Enhanced email validation

# ============================================================================
# RATE LIMITING & CACHING
# ============================================================================
Flask-Limiter==3.8.0
redis==5.2.0  # For rate limiting and caching
limits==3.13.0  # Required by Flask-Limiter
packaging>=21,<25 # Required by limits

# ============================================================================
# PERFORMANCE OPTIMIZATION
# ============================================================================
flask-compress==1.15
Flask-Caching==2.3.0  # Response caching

# ============================================================================
# API DOCUMENTATION
# ============================================================================
flasgger==0.9.7.1  # Swagger/OpenAPI documentation

# ============================================================================
# MONITORING, LOGGING & ERROR TRACKING
# ============================================================================
python-json-logger==3.2.1
prometheus-flask-exporter>=0.23.0  # Prometheus metrics (kept from original)
sentry-sdk[flask]==2.18.0  # Installed but not yet configured
                           # To enable: Set SENTRY_DSN in .env and initialize in app.py
                           # See: https://docs.sentry.io/platforms/python/guides/flask/
ddtrace==2.14.4 ; platform_system != "Windows"  # Datadog APM tracing
                 # Auto-instrumentation: ddtrace-run python main.py
                 # See: https://docs.datadoghq.com/tracing/trace_collection/dd_libraries/python/

# ============================================================================
# PROGRESS TRACKING
# ============================================================================
tqdm==4.67.1

# ============================================================================
# WEATHER DATA SOURCES
# ============================================================================
meteostat==1.6.8

# ============================================================================
# EXTERNAL DATA SOURCES (Free APIs)
# ============================================================================
# Open-Meteo - Weather forecasts & historical data (no API key needed)
openmeteo-requests==1.2.0
requests-cache==1.2.1  # Caching for Open-Meteo
retry-requests==2.0.0  # Retry logic for API calls

# NASA GPM/IMERG - Satellite rainfall data
# NOTE: These packages require HDF5 libraries on Windows.
# For Windows users, install via conda instead:
#   conda install -c conda-forge netcdf4 h5py xarray
# Or comment out if not using satellite rainfall data.
# netCDF4==1.7.1  # Requires HDF5 headers to build on Windows
# h5py==3.12.1
# xarray==2024.10.0

# PAGASA/Web Scraping
beautifulsoup4==4.12.3
lxml==5.3.0

# NAMRIA Tide Tables (PDF/Excel parsing)
tabula-py==2.9.3
openpyxl==3.1.5

# OpenStreetMap Queries
overpy==0.7

# Model Explainability (Large dependency ~500MB)
#shap==0.46.0    # Optional: Uncomment for model explainability features
                # Note: Large download (~500MB), install separately if needed:
                # pip install shap==0.46.0

# Geospatial (for flood mapping features)
geopandas==1.0.1
folium==0.18.0  # Interactive maps
shapely==2.0.6  # Geometric operations

# Time Series Analysis (for temporal pattern analysis)
statsmodels==0.14.4
prophet==1.1.6  # Facebook's forecasting tool
                  # Optional: Commented out due to heavy build requirements (cmdstan)
                  # Uncomment if needed: pip install prophet==1.1.6

# ============================================================================
# GRAPHQL
# ============================================================================
graphene==3.4.3  # GraphQL schema definition framework
graphql-server==3.0.0b7  # Use graphql-server instead of flask-graphql
#flask-graphql==2.0.1  # GraphQL endpoint integration
graphql-core==3.2.5  # GraphQL core library for schema and execution

# ============================================================================
# GOOGLE CLOUD / EARTH ENGINE
# ============================================================================
# Earth Engine Python API for satellite data
earthengine-api==1.4.3

# Google Cloud BigQuery for historical weather data
google-cloud-bigquery==3.27.0

# Google Authentication
google-auth==2.37.0
google-auth-oauthlib==1.2.1
google-auth-httplib2==0.2.0

# Google Cloud Storage (for caching Earth Engine exports)
google-cloud-storage==2.19.0

# Protocol buffers (required by Google Cloud)
protobuf>=4.21.0,<6.0.0
