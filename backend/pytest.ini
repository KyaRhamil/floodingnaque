[pytest]
# Test discovery
testpaths = tests
python_files = test_*.py
python_classes = Test*
python_functions = test_*

# Test markers for categorization
markers =
    unit: Unit tests (fast, no external dependencies)
    integration: Integration tests (require running server)
    security: Security-focused tests
    load: Load/performance tests (require locust)
    model: ML model-specific tests
    slow: Tests that take longer to run
    edge_cases: Edge case and boundary testing
    property: Property-based tests using Hypothesis
    contract: Contract tests for API compatibility
    snapshot: Snapshot tests for regression detection
    api_versioning: API versioning compatibility tests
    negative: Negative path tests (failures, errors, edge cases)
    performance: Performance and benchmark tests
    benchmark: Performance benchmark tests
    network: Network failure simulation tests
    timeout: Timeout handling tests
    rate_limit: Rate limiting tests
    asyncio: Async/await tests

# Default options with coverage enforcement
# Requires pytest-cov: pip install pytest-cov
addopts = -v --strict-markers --cov=app --cov-report=term-missing --cov-report=html --cov-fail-under=85

# Coverage settings
# - Minimum 85% coverage required to pass
# - HTML report generated in htmlcov/
# - Terminal output shows missing lines

# Warning filters
filterwarnings =
    # Ignore SQLAlchemy internal deprecation warning (utcfromtimestamp in sqltypes.py)
    # This is an internal SQLAlchemy issue, not in project code
    ignore:datetime.datetime.utcfromtimestamp\(\) is deprecated:DeprecationWarning:sqlalchemy
    # Ignore APScheduler pkg_resources deprecation warning (will be fixed in future version)
    ignore:pkg_resources is deprecated:UserWarning:apscheduler
    # Ignore numpy deprecation warnings in dependencies
    ignore:numpy.ndarray size changed:RuntimeWarning
    # Ignore hypothesis health checks for function-scoped fixtures
    ignore::hypothesis.errors.NonInteractiveExampleWarning

# Hypothesis configuration for property-based testing
# Max examples: Number of test cases to generate
# Deadline: Maximum time per test case (None = no limit)
# Verbosity: normal, verbose, debug
hypothesis_profile = default
hypothesis_verbosity = normal
hypothesis_max_examples = 100

# Syrupy configuration for snapshot testing
syrupy_update_snapshots = False  # Set to True to update snapshots

# Minimum pytest version
minversion = 7.0

# Test timeout (optional, requires pytest-timeout)
# timeout = 300
